<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Widevine DRM Test</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.min.js"></script>
  <style>
    body {
      background: #121212;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding-top: 40px;
    }
    select, video {
      margin-top: 20px;
    }
    video {
      width: 80%;
      max-width: 720px;
      border: 2px solid #555;
    }
  </style>
</head>
<body>
  <h1>Widevine DRM Stream Player</h1>
  <label for="streamSelect">Choose a stream:</label>
  <select id="streamSelect">
    <option value="/TV5.mpd">TV5</option>
    <option value="/PBOsd.mpd">PBO SD</option>
    <option value="/OnePH.mpd">One PH</option>
    <option value="/OneNews.mpd">One News</option>
    <option value="/Gtv.mpd">GTV</option>
    <option value="/1335.mpd">1335</option>
    <option value="/abs-cbn-cinemaone-dash-abscbnono.mpd">Cinema One</option>
  </select>

  <video id="video" controls autoplay></video>

  <script>
    async function initPlayer(manifestUri) {
      const video = document.getElementById('video');
      const player = new shaka.Player(video);

      player.configure({
        drm: {
          servers: {
            'com.widevine.alpha': '/api/widevine'
          }
        }
      });

      player.addEventListener('error', e => {
        console.error('Error code', e.detail.code, 'object', e.detail);
      });

      try {
        await player.load(manifestUri);
        console.log('Playing:', manifestUri);
      } catch (error) {
        console.error('Error loading stream:', error);
      }
    }

    // Load initial stream
    const select = document.getElementById('streamSelect');
    initPlayer(select.value);

    // Change stream on selection
    select.addEventListener('change', () => {
      initPlayer(select.value);
    });
  </script>
</body>
</html>
